import{a as J,b,c as X,d as ee,e as te,f as ne,g as re,h as oe,i as ie,j as ae,k as se,l as ce,m as le,n as ge,o as de,p as me}from"./chunk-PHLGMB3P.js";import{A as j,E as h,G as l,H as i,I as o,J as _,M as w,N as f,O as m,P as B,Q as V,R as N,S as K,T as E,U as c,V as y,W as S,Y as L,Z as q,a as D,b as A,c as d,ca as G,da as $,ea as Y,ga as H,ka as Q,l as C,ma as W,o as z,oa as Z,p as M,q as x,w as s,z as v}from"./chunk-2HVQLRQG.js";var P=class r{keys=new Map;currentKeyId=null;constructor(){this.initializeEncryption()}initializeEncryption(){return d(this,null,function*(){try{let t=this.generateKeyId(),e=yield this.generateKey();this.keys.set(t,{id:t,key:e,createdAt:new Date}),this.currentKeyId=t,console.log("\u{1F510} Encryption service initialized with key:",t)}catch(t){console.error("\u274C Failed to initialize encryption:",t)}})}generateKeyId(){return`key_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}generateKey(){return d(this,null,function*(){return yield crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"])})}encryptMessage(t,e){return d(this,null,function*(){try{return{encryptedData:this.simpleEncrypt(t),iv:"simple-cipher",keyId:"simple-key"}}catch(n){throw console.error("\u274C Encryption failed:",n),n}})}decryptMessage(t,e){return d(this,null,function*(){try{return this.simpleDecrypt(t.encryptedData)}catch(n){throw console.error("\u274C Decryption failed:",n),n}})}simpleEncrypt(t){return t.split("").map(n=>n>="a"&&n<="z"?String.fromCharCode((n.charCodeAt(0)-97+13)%26+97):n>="A"&&n<="Z"?String.fromCharCode((n.charCodeAt(0)-65+13)%26+65):n).join("")}simpleDecrypt(t){return t.split("").map(n=>n>="a"&&n<="z"?String.fromCharCode((n.charCodeAt(0)-97-13+26)%26+97):n>="A"&&n<="Z"?String.fromCharCode((n.charCodeAt(0)-65-13+26)%26+65):n).join("")}arrayBufferToBase64(t){let e=new Uint8Array(t),n="";for(let a=0;a<e.byteLength;a++)n+=String.fromCharCode(e[a]);return btoa(n)}base64ToArrayBuffer(t){let e=atob(t),n=new Uint8Array(e.length);for(let a=0;a<e.length;a++)n[a]=e.charCodeAt(a);return n.buffer}generateNewKey(){return d(this,null,function*(){try{let t=this.generateKeyId(),e=yield this.generateKey();return this.keys.set(t,{id:t,key:e,createdAt:new Date}),this.currentKeyId=t,console.log("\u{1F510} New encryption key generated:",t),t}catch(t){throw console.error("\u274C Failed to generate new key:",t),t}})}getCurrentKeyId(){return this.currentKeyId}isEncryptionAvailable(){return this.currentKeyId!==null&&this.keys.has(this.currentKeyId)}getEncryptionStatus(){return{available:this.isEncryptionAvailable(),keyId:this.currentKeyId,keyCount:this.keys.size}}static \u0275fac=function(e){return new(e||r)};static \u0275prov=C({token:r,factory:r.\u0275fac,providedIn:"root"})};var F=class r{constructor(t,e){this.environmentService=t;this.encryptionService=e}messageCallbacks=new Map;pollingIntervals=new Map;mockMessages=[];queryDatabase(n){return d(this,arguments,function*(t,e=[]){if(this.environmentService.isLocalEnvironment())return console.log("\u{1F527} Local development: Skipping chat database query"),[];try{let g=yield(yield fetch("/.netlify/functions/db-pg",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:t,params:e})})).json();if(!g.ok)throw new Error(g.error||"Database query failed");return g.data}catch(a){throw console.error("Database query error:",a),a}})}decryptAllMessages(t,e){return d(this,null,function*(){return yield Promise.all(t.map(a=>d(this,null,function*(){if(a.decryptedContent)return a;try{let g=yield this.decryptMessage(a,e);return A(D({},a),{decryptedContent:g})}catch(g){return console.error("Failed to decrypt message:",g),A(D({},a),{decryptedContent:a.content})}})))})}decryptMessage(t,e){return d(this,null,function*(){try{if(!t.encrypted||!t.encryption_data)return t.content;let n=yield this.encryptionService.decryptMessage(t.encryption_data,e);return console.log("\u{1F513} Message decrypted successfully"),n}catch(n){return console.error("\u274C Failed to decrypt message:",n),"[Encrypted message - decryption failed]"}})}fetchMessages(t){return d(this,null,function*(){if(this.environmentService.isLocalEnvironment())return{data:this.mockMessages.filter(n=>n.room_id===t).sort((n,a)=>new Date(n.created_at).getTime()-new Date(a.created_at).getTime()),error:null};try{let e=new Date(Date.now()-864e5).toISOString(),n=`
        SELECT * FROM messages 
        WHERE room_id = $1 AND created_at > $2
        ORDER BY created_at ASC
      `,a=[t,e];return{data:(yield this.queryDatabase(n,a))||[],error:null}}catch(e){return{data:null,error:e}}})}sendMessage(t,e,n,a){return d(this,null,function*(){if(this.environmentService.isLocalEnvironment()){let g=e,u;try{u=yield this.encryptionService.encryptMessage(e,t),g=u.encryptedData,console.log("\u{1F510} Message encrypted for local development")}catch(O){console.warn("\u26A0\uFE0F Encryption failed, sending unencrypted message:",O)}let p={id:`mock-msg-${Date.now()}`,room_id:t,content:g,user_id:n,username:a,created_at:new Date().toISOString(),encrypted:u!==void 0,encryption_data:u};return this.mockMessages.push(p),setTimeout(()=>{(this.messageCallbacks.get(t)||[]).forEach(I=>I(p))},100),{data:p,error:null}}try{let g=`
        INSERT INTO messages (room_id, content, user_id, username, created_at)
        VALUES ($1, $2, $3, $4, NOW())
        RETURNING *
      `,u=[t,e,n,a];return{data:(yield this.queryDatabase(g,u))[0]||null,error:null}}catch(g){return{data:null,error:g}}})}listenToRoom(t,e){this.messageCallbacks.has(t)||this.messageCallbacks.set(t,[]),this.messageCallbacks.get(t).push(e),this.pollingIntervals.has(t)||this.startPolling(t)}startPolling(t){return d(this,null,function*(){let e=new Date().toISOString(),n=()=>d(this,null,function*(){try{let g=`
          SELECT * FROM messages 
          WHERE room_id = $1 AND created_at > $2
          ORDER BY created_at ASC
        `,u=[t,e],p=yield this.queryDatabase(g,u);if(p&&p.length>0){e=p[p.length-1].created_at;let O=this.messageCallbacks.get(t)||[];p.forEach(I=>{O.forEach(U=>U(I))})}}catch(g){console.error("Polling error:",g)}}),a=window.setInterval(n,2e3);this.pollingIntervals.set(t,a)})}unsubscribeFromRoom(t){this.messageCallbacks.delete(t);let e=this.pollingIntervals.get(t);e&&(clearInterval(e),this.pollingIntervals.delete(t))}unsubscribeFromAllRooms(){this.messageCallbacks.clear(),this.pollingIntervals.forEach(t=>{clearInterval(t)}),this.pollingIntervals.clear()}static \u0275fac=function(e){return new(e||r)(z(le),z(P))};static \u0275prov=C({token:r,factory:r.\u0275fac,providedIn:"root"})};var R=class r{USERNAME_KEY="vaultday_username";USER_ID_KEY="vaultday_user_id";constructor(){}saveUsername(t){try{localStorage.setItem(this.USERNAME_KEY,t)}catch(e){console.warn("Failed to save username to localStorage:",e)}}getUsername(){try{return localStorage.getItem(this.USERNAME_KEY)}catch(t){return console.warn("Failed to get username from localStorage:",t),null}}clearUsername(){try{localStorage.removeItem(this.USERNAME_KEY)}catch(t){console.warn("Failed to clear username from localStorage:",t)}}saveUserId(t){try{localStorage.setItem(this.USER_ID_KEY,t)}catch(e){console.warn("Failed to save user ID to localStorage:",e)}}getUserId(){try{return localStorage.getItem(this.USER_ID_KEY)}catch(t){return console.warn("Failed to get user ID from localStorage:",t),null}}clearUserId(){try{localStorage.removeItem(this.USER_ID_KEY)}catch(t){console.warn("Failed to clear user ID from localStorage:",t)}}clearAllUserData(){this.clearUsername(),this.clearUserId()}hasUserData(){return this.getUsername()!==null&&this.getUserId()!==null}static \u0275fac=function(e){return new(e||r)};static \u0275prov=C({token:r,factory:r.\u0275fac,providedIn:"root"})};var T=class r{userColors=new Map;colorPalette=["#8b5cf6","#06b6d4","#10b981","#f59e0b","#ef4444","#3b82f6","#84cc16","#f97316","#ec4899","#6366f1","#14b8a6","#a855f7"];constructor(){}getUserColor(t){if(!this.userColors.has(t)){let n=this.hashString(t)%this.colorPalette.length;this.userColors.set(t,this.colorPalette[n])}return this.userColors.get(t)}getUserColorLight(t){let e=this.getUserColor(t);return this.lightenColor(e,.2)}getUserColorDark(t){let e=this.getUserColor(t);return this.darkenColor(e,.3)}hashString(t){let e=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);e=(e<<5)-e+a,e=e&e}return Math.abs(e)}lightenColor(t,e){let n=parseInt(t.replace("#",""),16),a=Math.round(2.55*e*100),g=(n>>16)+a,u=(n>>8&255)+a,p=(n&255)+a;return"#"+(16777216+(g<255?g<1?0:g:255)*65536+(u<255?u<1?0:u:255)*256+(p<255?p<1?0:p:255)).toString(16).slice(1)}darkenColor(t,e){let n=parseInt(t.replace("#",""),16),a=Math.round(2.55*e*100),g=(n>>16)-a,u=(n>>8&255)-a,p=(n&255)-a;return"#"+(16777216+(g>255?255:g<0?0:g)*65536+(u>255?255:u<0?0:u)*256+(p>255?255:p<0?0:p)).toString(16).slice(1)}clearUserColors(){this.userColors.clear()}getAllUserColors(){return new Map(this.userColors)}static \u0275fac=function(e){return new(e||r)};static \u0275prov=C({token:r,factory:r.\u0275fac,providedIn:"root"})};var _e=["messagesContainer"];function ye(r,t){r&1&&(i(0,"div",36)(1,"span",37),c(2,"End-to-End Encrypted"),o()())}function be(r,t){r&1&&(i(0,"span"),c(1,"M\u1EADt kh\u1EA9u l\xE0 b\u1EAFt bu\u1ED9c"),o())}function Me(r,t){if(r&1&&(i(0,"div",50),h(1,be,2,0,"span",51),o()),r&2){let e=m(2);s(),l("ngIf",e.password==null||e.password.errors==null?null:e.password.errors.required)}}function xe(r,t){if(r&1){let e=w();i(0,"div",38)(1,"div",39)(2,"div",40)(3,"h2",41)(4,"span",42),c(5,"\u25CF"),o(),c(6," Ph\xF2ng \u0111\u01B0\u1EE3c b\u1EA3o v\u1EC7 "),o(),i(7,"p",43),c(8,"Nh\u1EADp m\u1EADt kh\u1EA9u \u0111\u1EC3 v\xE0o ph\xF2ng"),o()(),i(9,"div",44)(10,"form",45),f("ngSubmit",function(){M(e);let a=m();return x(a.verifyPassword())}),i(11,"div",46),_(12,"input",47),h(13,Me,2,1,"div",48),o(),i(14,"button",49),c(15," X\xE1c nh\u1EADn "),o()()()()()}if(r&2){let e=m();s(10),l("formGroup",e.passwordForm),s(2),E("error",(e.password==null?null:e.password.invalid)&&(e.password==null?null:e.password.touched)),s(),l("ngIf",(e.password==null?null:e.password.invalid)&&(e.password==null?null:e.password.touched)),s(),l("disabled",e.passwordForm.invalid)}}function Pe(r,t){r&1&&(i(0,"p",69),c(1," \u2705 Ph\xF2ng n\xE0y s\u1EBD hi\u1EC3n th\u1ECB trong danh s\xE1ch ph\xF2ng c\xF4ng khai "),o())}function Oe(r,t){r&1&&(i(0,"p",69),c(1," \u{1F512} Ph\xF2ng n\xE0y s\u1EBD \u1EA9n kh\u1ECFi danh s\xE1ch ph\xF2ng c\xF4ng khai "),o())}function we(r,t){if(r&1){let e=w();i(0,"div",52)(1,"div",53)(2,"div",54)(3,"h3",55),c(4,"C\xE0i \u0110\u1EB7t Ph\xF2ng"),o(),i(5,"button",56),f("click",function(){M(e);let a=m();return x(a.toggleRoomSettings())}),i(6,"span",57),c(7,"\xD7"),o()()(),i(8,"div",58)(9,"div",59)(10,"div",60)(11,"span",61),c(12,"\u25CF"),o(),i(13,"span",62),c(14,"Hi\u1EC3n th\u1ECB c\xF4ng khai"),o()(),i(15,"div",63)(16,"label",64)(17,"input",65),f("change",function(){M(e);let a=m();return x(a.toggleRoomVisibility())}),o(),_(18,"span",66),o()()(),i(19,"div",67),h(20,Pe,2,0,"p",68)(21,Oe,2,0,"p",68),o()()()()}if(r&2){let e=m();s(17),l("checked",e.roomVisibilityToggle),s(3),l("ngIf",e.roomVisibilityToggle),s(),l("ngIf",!e.roomVisibilityToggle)}}function Ee(r,t){r&1&&(i(0,"span"),c(1,"T\xEAn l\xE0 b\u1EAFt bu\u1ED9c"),o())}function Se(r,t){if(r&1&&(i(0,"div",50),h(1,Ee,2,0,"span",51),o()),r&2){let e=m(2);s(),l("ngIf",e.username==null||e.username.errors==null?null:e.username.errors.required)}}function Ie(r,t){if(r&1){let e=w();i(0,"div",70)(1,"div",39)(2,"div",40)(3,"h2",41)(4,"span",42),c(5,"\u25CF"),o(),c(6," Ch\xE0o m\u1EEBng b\u1EA1n! "),o(),i(7,"p",43),c(8,"Nh\u1EADp t\xEAn \u0111\u1EC3 b\u1EAFt \u0111\u1EA7u tr\xF2 chuy\u1EC7n"),o()(),i(9,"div",44)(10,"form",71),f("ngSubmit",function(){M(e);let a=m();return x(a.setUsername())}),i(11,"div",46),_(12,"input",72),h(13,Se,2,1,"div",48),o(),i(14,"button",73),c(15," B\u1EAFt \u0111\u1EA7u chat "),o()()()()()}if(r&2){let e=m();s(10),l("formGroup",e.usernameForm),s(2),E("error",(e.username==null?null:e.username.invalid)&&(e.username==null?null:e.username.touched)),l("value",e.currentUsername||""),s(),l("ngIf",(e.username==null?null:e.username.invalid)&&(e.username==null?null:e.username.touched)),s(),l("disabled",e.usernameForm.invalid)}}function ke(r,t){if(r&1&&(i(0,"div",74)(1,"span",75),c(2,"\u25CF"),o(),c(3),o()),r&2){let e=m();s(3),S(" ",e.errorMessage," ")}}function Fe(r,t){r&1&&(i(0,"div",76),_(1,"div",77),i(2,"p"),c(3,"\u0110ang t\u1EA3i tin nh\u1EAFn..."),o()())}function Re(r,t){r&1&&(i(0,"div",81)(1,"div",82),c(2,"\u25CF"),o(),i(3,"h3"),c(4,"Ch\u01B0a c\xF3 tin nh\u1EAFn n\xE0o"),o(),i(5,"p"),c(6,"H\xE3y l\xE0 ng\u01B0\u1EDDi \u0111\u1EA7u ti\xEAn g\u1EEDi tin nh\u1EAFn!"),o()())}function Te(r,t){if(r&1&&(i(0,"div",91),c(1),o()),r&2){let e=m().$implicit,n=m(3);s(),S(" ",n.getMessageUsername(e)," ")}}function De(r,t){if(r&1&&(i(0,"div",85)(1,"div",86),h(2,Te,2,1,"div",87),i(3,"div",88),c(4),o(),i(5,"div",89)(6,"span",90),c(7),L(8,"date"),o()()()()),r&2){let e=t.$implicit,n=m(3);K("--user-color",n.getUserColor(e.user_id||""))("--user-color-light",n.getUserColorLight(e.user_id||""))("--user-color-dark",n.getUserColorDark(e.user_id||"")),E("own-message",n.isOwnMessage(e))("other-message",!n.isOwnMessage(e)),s(2),l("ngIf",!n.isOwnMessage(e)),s(2),y(e.decryptedContent||e.content),s(3),y(q(8,13,e.created_at,"HH:mm"))}}function Ae(r,t){if(r&1&&(i(0,"div",83),h(1,De,9,16,"div",84),o()),r&2){let e=m(2);s(),l("ngForOf",e.messages)("ngForTrackBy",e.trackByMessageId)}}function ze(r,t){if(r&1&&(i(0,"div",78,0),h(2,Re,7,0,"div",79)(3,Ae,2,2,"div",80),o()),r&2){let e=m();s(2),l("ngIf",e.messages.length===0),s(),l("ngIf",e.messages.length>0)}}function Ue(r,t){r&1&&(i(0,"span",100),c(1,"\u2192"),o())}function je(r,t){if(r&1&&(i(0,"span",101),c(1),o()),r&2){let e=m(2);s(),y(e.getRemainingCooldown())}}function Be(r,t){r&1&&(i(0,"span"),c(1,"Tin nh\u1EAFn l\xE0 b\u1EAFt bu\u1ED9c"),o())}function Ve(r,t){if(r&1&&(i(0,"div",50),h(1,Be,2,0,"span",51),o()),r&2){let e=m(2);s(),l("ngIf",e.content==null||e.content.errors==null?null:e.content.errors.required)}}function Ne(r,t){if(r&1){let e=w();i(0,"div",92)(1,"form",93),f("ngSubmit",function(){M(e);let a=m();return x(a.sendMessage())}),i(2,"div",94)(3,"div",95),_(4,"input",96),o(),i(5,"button",97),h(6,Ue,2,0,"span",98)(7,je,2,1,"span",99),o()(),h(8,Ve,2,1,"div",48),o()()}if(r&2){let e=m();s(),l("formGroup",e.messageForm),s(3),E("error",(e.content==null?null:e.content.invalid)&&(e.content==null?null:e.content.touched)),s(),l("disabled",e.messageForm.invalid||!e.canSendMessage())("title",e.canSendMessage()?"G\u1EEDi tin nh\u1EAFn":"Vui l\xF2ng \u0111\u1EE3i "+e.getRemainingCooldown()+" gi\xE2y"),s(),l("ngIf",e.canSendMessage()),s(),l("ngIf",!e.canSendMessage()),s(),l("ngIf",(e.content==null?null:e.content.invalid)&&(e.content==null?null:e.content.touched))}}function Ke(r,t){if(r&1&&(i(0,"div",102)(1,"span",75),c(2,"\u25CF"),o(),c(3),o()),r&2){let e=m();s(3),S(" ",e.errorMessage," ")}}function Le(r,t){if(r&1&&(i(0,"div",103)(1,"span",104),c(2,"\u25CF"),o(),c(3),o()),r&2){let e=m();s(3),S(" ",e.successMessage," ")}}var ue=class r{constructor(t,e,n,a,g,u,p,O,I,U,qe){this.route=t;this.router=e;this.fb=n;this.chatService=a;this.databaseService=g;this.seoService=u;this.encryptionService=p;this.storageService=O;this.soundService=I;this.userColorService=U;this.themeService=qe;this.messageForm=this.fb.group({content:["",[b.required,b.minLength(1)]]});let he=this.storageService.getUsername();this.usernameForm=this.fb.group({username:[he||"",[b.required,b.minLength(1)]]}),this.passwordForm=this.fb.group({password:["",[b.required,b.minLength(1)]]})}roomId=null;room=null;messages=[];messageForm;usernameForm;passwordForm;currentUsername="";currentUserId="";isLoading=!1;errorMessage="";successMessage="";showPasswordModal=!1;isPasswordRequired=!1;showRoomSettings=!1;roomVisibilityToggle=!1;lastMessageTime=0;rateLimitSeconds=5;cooldownInterval;messagesContainerRef;ngOnInit(){return d(this,null,function*(){if(this.roomId=this.route.snapshot.paramMap.get("id"),!this.roomId){this.router.navigate(["/"]);return}this.loadCachedUserData(),yield this.loadRoomDetails(),this.room&&this.seoService.setChatRoomSEO(this.room.name),this.room?.password?(this.isPasswordRequired=!0,this.showPasswordModal=!0):(yield this.loadMessages(),this.subscribeToMessages(),setTimeout(()=>this.scrollToBottom(),100))})}ngOnDestroy(){this.roomId&&this.chatService.unsubscribeFromRoom(this.roomId),this.cooldownInterval&&clearInterval(this.cooldownInterval)}loadCachedUserData(){let t=this.storageService.getUsername(),e=this.storageService.getUserId();t&&e&&(this.currentUsername=t,this.currentUserId=e,console.log("\u2705 Loaded cached user data:",{username:t,userId:e}))}loadRoomDetails(){return d(this,null,function*(){if(!this.roomId)return;let{data:t,error:e}=yield this.databaseService.getRoomById(this.roomId);e?(console.error("Error loading room:",e),this.errorMessage="Ph\xF2ng kh\xF4ng t\u1ED3n t\u1EA1i"):(this.room=t,this.roomVisibilityToggle=this.room?.is_public||!1)})}loadMessages(){return d(this,null,function*(){if(!this.roomId)return;this.isLoading=!0;let{data:t,error:e}=yield this.chatService.fetchMessages(this.roomId);e?(console.error("Error loading messages:",e),this.errorMessage="Kh\xF4ng th\u1EC3 t\u1EA3i tin nh\u1EAFn"):this.messages=yield this.chatService.decryptAllMessages(t||[],this.roomId),this.isLoading=!1,setTimeout(()=>this.scrollToBottom(),0)})}subscribeToMessages(){this.roomId&&(this.chatService.unsubscribeFromRoom(this.roomId),this.chatService.listenToRoom(this.roomId,t=>d(this,null,function*(){if(!this.messages.some(n=>n.id===t.id)){let n=yield this.chatService.decryptAllMessages([t],this.roomId);this.messages.push(n[0]),setTimeout(()=>this.scrollToBottom(),0)}})))}verifyPassword(){return d(this,null,function*(){if(this.passwordForm.valid&&this.room){let{password:t}=this.passwordForm.value;t===this.room.password?(this.showPasswordModal=!1,this.isPasswordRequired=!1,yield this.loadMessages(),this.subscribeToMessages(),this.soundService.playSuccess(),setTimeout(()=>this.scrollToBottom(),100)):(this.errorMessage="M\u1EADt kh\u1EA9u kh\xF4ng \u0111\xFAng",this.passwordForm.reset(),this.soundService.playError())}})}setUsername(){this.usernameForm.valid&&(this.currentUsername=this.usernameForm.value.username,this.currentUserId=`user-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,this.storageService.saveUsername(this.currentUsername),this.storageService.saveUserId(this.currentUserId),console.log("\u2705 Saved user data to cache:",{username:this.currentUsername,userId:this.currentUserId}))}decryptMessage(t){return d(this,null,function*(){try{return yield this.chatService.decryptMessage(t,this.roomId)}catch(e){return console.error("Failed to decrypt message:",e),t.content}})}sendMessage(){return d(this,null,function*(){if(this.messageForm.valid&&this.roomId&&this.currentUsername&&this.currentUserId){if(!this.canSendMessage()){let n=this.getRemainingCooldown();this.errorMessage=`Vui l\xF2ng \u0111\u1EE3i ${n} gi\xE2y tr\u01B0\u1EDBc khi g\u1EEDi tin nh\u1EAFn ti\u1EBFp theo`,this.soundService.playError();return}let{content:t}=this.messageForm.value,{error:e}=yield this.chatService.sendMessage(this.roomId,t,this.currentUserId,this.currentUsername);e?(console.error("Error sending message:",e),this.errorMessage="Kh\xF4ng th\u1EC3 g\u1EEDi tin nh\u1EAFn",this.soundService.playError()):(this.messageForm.reset(),this.errorMessage="",this.lastMessageTime=Date.now(),this.startCooldownTimer(),this.soundService.playMessageSend(),setTimeout(()=>this.scrollToBottom(),0))}})}goBack(){this.router.navigate(["/"])}toggleRoomSettings(){this.showRoomSettings=!this.showRoomSettings}toggleRoomVisibility(){return d(this,null,function*(){if(!this.roomId)return;let t=!this.roomVisibilityToggle,{data:e,error:n}=yield this.databaseService.updateRoomVisibility(this.roomId,t);n?(console.error("Error updating room visibility:",n),this.errorMessage="Kh\xF4ng th\u1EC3 c\u1EADp nh\u1EADt tr\u1EA1ng th\xE1i ph\xF2ng",this.soundService.playError()):(this.roomVisibilityToggle=t,this.room&&(this.room.is_public=t),this.successMessage=t?"Ph\xF2ng \u0111\xE3 \u0111\u01B0\u1EE3c c\xF4ng khai":"Ph\xF2ng \u0111\xE3 \u0111\u01B0\u1EE3c \u1EA9n",this.soundService.playToggle(),setTimeout(()=>{this.successMessage=""},3e3))})}get content(){return this.messageForm.get("content")}get username(){return this.usernameForm.get("username")}get password(){return this.passwordForm.get("password")}trackByMessageId(t,e){return e.id}isOwnMessage(t){return t.user_id===this.currentUserId}getMessageUsername(t){return t.username?t.username:t.user_id?`Ng\u01B0\u1EDDi d\xF9ng ${t.user_id.substring(0,4)}`:"\u1EA8n danh"}getUserColor(t){return this.userColorService.getUserColor(t)}getUserColorLight(t){return this.userColorService.getUserColorLight(t)}getUserColorDark(t){return this.userColorService.getUserColorDark(t)}canSendMessage(){return Date.now()-this.lastMessageTime>=this.rateLimitSeconds*1e3}getRemainingCooldown(){let e=Date.now()-this.lastMessageTime,n=this.rateLimitSeconds*1e3-e;return Math.max(0,Math.ceil(n/1e3))}startCooldownTimer(){this.cooldownInterval&&clearInterval(this.cooldownInterval),this.cooldownInterval=setInterval(()=>{this.canSendMessage()&&(clearInterval(this.cooldownInterval),this.cooldownInterval=null)},1e3)}scrollToBottom(){let t=this.messagesContainerRef?.nativeElement;t&&(t.scrollTop=t.scrollHeight)}get isDark(){return this.themeService.isDark()}toggleTheme(){this.themeService.toggleTheme()}static \u0275fac=function(e){return new(e||r)(v(Q),v(W),v(oe),v(F),v(ge),v(de),v(P),v(R),v(se),v(T),v(me))};static \u0275cmp=j({type:r,selectors:[["app-chat-room"]],viewQuery:function(e,n){if(e&1&&B(_e,5),e&2){let a;V(a=N())&&(n.messagesContainerRef=a.first)}},decls:44,vars:17,consts:[["messagesContainer",""],[1,"chat-room-container"],[1,"chat-header"],[1,"header-left"],["appSoundClick","","soundType","button",1,"back-button",3,"click"],[1,"back-icon"],[1,"back-text"],[1,"header-center"],[1,"room-logo-container"],[1,"room-title"],[1,"room-status"],[1,"cleanup-notice"],[1,"cleanup-text"],["class","encryption-status",4,"ngIf"],[1,"header-right"],["appSoundClick","","soundType","button",1,"theme-toggle",3,"click","title"],[1,"theme-icon"],[1,"theme-label"],[1,"modern-toggle-switch",3,"title"],["type","checkbox","aria-label","B\u1EADt/t\u1EAFt hi\u1EC3n th\u1ECB c\xF4ng khai","appSoundClick","","soundType","toggle",3,"change","checked"],[1,"toggle-track"],[1,"toggle-text"],[1,"toggle-thumb"],[1,"countdown-section"],[1,"chat-content"],["class","password-modal",4,"ngIf"],["class","room-settings-panel",4,"ngIf"],["class","username-modal",4,"ngIf"],["class","error-banner",4,"ngIf"],["class","loading-container",4,"ngIf"],["class","messages-container",4,"ngIf"],["class","message-input-container",4,"ngIf"],["class","error-toast",4,"ngIf"],["class","success-toast",4,"ngIf"],[1,"version-footer"],[1,"version-text"],[1,"encryption-status"],[1,"encryption-text"],[1,"password-modal"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],[1,"modal-icon"],[1,"modal-description"],[1,"modal-body"],[1,"password-form",3,"ngSubmit","formGroup"],[1,"form-group"],["type","password","formControlName","password","placeholder","Nh\u1EADp m\u1EADt kh\u1EA9u...",1,"form-input"],["class","error-message",4,"ngIf"],["type","submit","appSoundClick","","soundType","button",1,"btn-primary","btn-lg","w-full",3,"disabled"],[1,"error-message"],[4,"ngIf"],[1,"room-settings-panel"],[1,"settings-content"],[1,"settings-header"],[1,"settings-title"],[1,"close-settings",3,"click"],[1,"close-icon"],[1,"settings-body"],[1,"setting-item"],[1,"setting-label"],[1,"setting-icon"],[1,"setting-text"],[1,"setting-control"],[1,"toggle-switch"],["type","checkbox",3,"change","checked"],[1,"toggle-slider"],[1,"setting-description"],["class","description-text",4,"ngIf"],[1,"description-text"],[1,"username-modal"],[1,"username-form",3,"ngSubmit","formGroup"],["type","text","formControlName","username","placeholder","Nh\u1EADp t\xEAn c\u1EE7a b\u1EA1n...",1,"form-input",3,"value"],["type","submit","appSoundClick","","soundType","success",1,"btn-primary","btn-lg","w-full",3,"disabled"],[1,"error-banner"],[1,"error-icon"],[1,"loading-container"],[1,"loading-spinner"],[1,"messages-container"],["class","empty-messages",4,"ngIf"],["class","messages-list",4,"ngIf"],[1,"empty-messages"],[1,"empty-icon"],[1,"messages-list"],["class","message-item",3,"own-message","other-message","--user-color","--user-color-light","--user-color-dark",4,"ngFor","ngForOf","ngForTrackBy"],[1,"message-item"],[1,"message-content"],["class","message-username",4,"ngIf"],[1,"message-text"],[1,"message-meta"],[1,"message-time"],[1,"message-username"],[1,"message-input-container"],[1,"message-form",3,"ngSubmit","formGroup"],[1,"input-group"],[1,"input-wrapper"],["type","text","formControlName","content","placeholder","Nh\u1EADp tin nh\u1EAFn...",1,"message-input"],["type","submit","appSoundClick","","soundType","message",1,"send-button",3,"disabled","title"],["class","send-icon",4,"ngIf"],["class","cooldown-text",4,"ngIf"],[1,"send-icon"],[1,"cooldown-text"],[1,"error-toast"],[1,"success-toast"],[1,"success-icon"]],template:function(e,n){e&1&&(i(0,"div",1)(1,"div",2)(2,"div",3)(3,"button",4),f("click",function(){return n.goBack()}),i(4,"span",5),c(5,"\u2190"),o(),i(6,"span",6),c(7,"Quay l\u1EA1i"),o()()(),i(8,"div",7)(9,"div",8)(10,"h1",9),c(11),o()(),i(12,"div",10)(13,"div",11)(14,"span",12),c(15,"T\u1EF1 \u0111\u1ED9ng x\xF3a l\xFAc 00:00"),o()(),h(16,ye,3,0,"div",13),o()(),i(17,"div",14)(18,"button",15),f("click",function(){return n.toggleTheme()}),i(19,"span",16),c(20),o(),i(21,"span",17),c(22),o()(),i(23,"label",18)(24,"input",19),f("change",function(){return n.toggleRoomVisibility()}),o(),i(25,"span",20)(26,"span",21),c(27),o(),_(28,"span",22),o()()()(),i(29,"div",23),_(30,"app-countdown-timer"),o(),i(31,"div",24),h(32,xe,16,5,"div",25)(33,we,22,3,"div",26)(34,Ie,16,6,"div",27)(35,ke,4,1,"div",28)(36,Fe,4,0,"div",29)(37,ze,4,2,"div",30)(38,Ne,9,8,"div",31),o(),h(39,Ke,4,1,"div",32)(40,Le,4,1,"div",33),i(41,"div",34)(42,"p",35),c(43,"Version 0.1"),o()()()),e&2&&(s(11),y((n.room==null?null:n.room.name)||"\u0110ang t\u1EA3i..."),s(5),l("ngIf",n.encryptionService.isEncryptionAvailable()),s(2),l("title",n.isDark?"Chuy\u1EC3n sang Light Mode":"Chuy\u1EC3n sang Dark Mode"),s(2),y(n.isDark?"\u2600":"\u25CB"),s(2),y(n.isDark?"Light":"Dark"),s(),l("title",n.roomVisibilityToggle?"\u0110ang c\xF4ng khai":"\u0110ang \u1EA9n"),s(),l("checked",!n.roomVisibilityToggle),s(3),y(n.roomVisibilityToggle?"":"\u1EA8N"),s(5),l("ngIf",n.showPasswordModal),s(),l("ngIf",n.showRoomSettings),s(),l("ngIf",!n.currentUsername&&!n.isPasswordRequired),s(),l("ngIf",n.errorMessage),s(),l("ngIf",n.isLoading),s(),l("ngIf",!n.isLoading&&n.currentUsername&&!n.isPasswordRequired),s(),l("ngIf",n.currentUsername&&!n.isPasswordRequired),s(),l("ngIf",n.errorMessage),s(),l("ngIf",n.successMessage))},dependencies:[H,G,$,Z,ie,te,J,X,ee,ne,re,ae,ce,Y],styles:['.chat-room-container[_ngcontent-%COMP%]{width:100%;max-width:500px;height:100vh;margin:0 auto;background:var(--bg-primary);border:1px solid var(--border-neon);border-radius:var(--radius-lg);box-shadow:var(--shadow-sm);display:flex;flex-direction:column;overflow:hidden}.room-settings-panel[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000c;display:flex;align-items:center;justify-content:center;z-index:1000;padding:var(--space-lg);animation:fadeIn .3s ease-out}.settings-content[_ngcontent-%COMP%]{background:var(--bg-card);border:2px solid var(--border-neon);border-radius:var(--radius-lg);box-shadow:var(--shadow-sm);width:100%;max-width:400px;animation:slideIn .3s ease-out}.settings-header[_ngcontent-%COMP%]{padding:var(--space-lg);border-bottom:1px solid var(--border-neon);display:flex;justify-content:space-between;align-items:center;background:var(--bg-secondary)}.settings-header[_ngcontent-%COMP%]   .settings-title[_ngcontent-%COMP%]{font-size:var(--font-size-xl);font-weight:600;color:var(--text-primary);margin:0}.settings-header[_ngcontent-%COMP%]   .close-settings[_ngcontent-%COMP%]{background:none;border:none;color:var(--text-secondary);cursor:pointer;padding:var(--space-sm);border-radius:var(--radius-md);transition:all .2s ease}.settings-header[_ngcontent-%COMP%]   .close-settings[_ngcontent-%COMP%]:hover{background:rgba(var(--error),.1);color:var(--error)}.settings-header[_ngcontent-%COMP%]   .close-settings[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{font-size:var(--font-size-lg)}.settings-body[_ngcontent-%COMP%]{padding:var(--space-lg)}.settings-body[_ngcontent-%COMP%]   .setting-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--space-lg)}.settings-body[_ngcontent-%COMP%]   .setting-item[_ngcontent-%COMP%]   .setting-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-sm)}.settings-body[_ngcontent-%COMP%]   .setting-item[_ngcontent-%COMP%]   .setting-label[_ngcontent-%COMP%]   .setting-icon[_ngcontent-%COMP%]{font-size:var(--font-size-lg)}.settings-body[_ngcontent-%COMP%]   .setting-item[_ngcontent-%COMP%]   .setting-label[_ngcontent-%COMP%]   .setting-text[_ngcontent-%COMP%]{font-size:var(--font-size-base);color:var(--text-primary);font-weight:500}.settings-body[_ngcontent-%COMP%]   .setting-item[_ngcontent-%COMP%]   .setting-control[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:50px;height:24px}.settings-body[_ngcontent-%COMP%]   .setting-item[_ngcontent-%COMP%]   .setting-control[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.settings-body[_ngcontent-%COMP%]   .setting-item[_ngcontent-%COMP%]   .setting-control[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .toggle-slider[_ngcontent-%COMP%]{background-color:var(--neon-primary)}.settings-body[_ngcontent-%COMP%]   .setting-item[_ngcontent-%COMP%]   .setting-control[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .toggle-slider[_ngcontent-%COMP%]:before{transform:translate(26px)}.settings-body[_ngcontent-%COMP%]   .setting-item[_ngcontent-%COMP%]   .setting-control[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]   .toggle-slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:var(--bg-tertiary);border:1px solid var(--border-muted);transition:.3s;border-radius:24px}.settings-body[_ngcontent-%COMP%]   .setting-item[_ngcontent-%COMP%]   .setting-control[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]   .toggle-slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:18px;width:18px;left:2px;bottom:2px;background-color:var(--text-primary);transition:.3s;border-radius:50%}.settings-body[_ngcontent-%COMP%]   .setting-description[_ngcontent-%COMP%]{margin-top:var(--space-md);padding:var(--space-md);background:var(--bg-tertiary);border-radius:var(--radius-md);border:1px solid var(--border-muted)}.settings-body[_ngcontent-%COMP%]   .setting-description[_ngcontent-%COMP%]   .description-text[_ngcontent-%COMP%]{font-size:var(--font-size-sm);color:var(--text-secondary);margin:0;line-height:1.4}.username-modal[_ngcontent-%COMP%], .password-modal[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000c;display:flex;align-items:center;justify-content:center;z-index:1000;padding:var(--space-lg)}.modal-content[_ngcontent-%COMP%]{background:var(--bg-card);border:2px solid var(--border-neon);border-radius:var(--radius-lg);box-shadow:var(--shadow-sm);width:100%;max-width:400px;animation:fadeIn .3s ease-out}.modal-header[_ngcontent-%COMP%]{padding:var(--space-lg);border-bottom:1px solid var(--border-neon);text-align:center;background:var(--bg-secondary)}.modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{font-size:var(--font-size-xl);font-weight:600;color:var(--text-primary);margin-bottom:var(--space-sm);display:flex;align-items:center;justify-content:center;gap:var(--space-sm)}.modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]   .modal-icon[_ngcontent-%COMP%]{font-size:var(--font-size-lg)}.modal-header[_ngcontent-%COMP%]   .modal-description[_ngcontent-%COMP%]{font-size:var(--font-size-sm);color:var(--text-secondary);margin:0}.modal-body[_ngcontent-%COMP%]{padding:var(--space-lg)}.username-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%], .password-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:var(--space-lg)}.username-form[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%], .password-form[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{width:100%;padding:var(--space-md);border:2px solid var(--border-neon);border-radius:var(--radius-md);background:var(--bg-secondary);color:var(--text-primary);font-family:var(--font-family);transition:all .3s ease;box-shadow:var(--shadow-sm)}.username-form[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]:focus, .password-form[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--neon-accent);box-shadow:var(--neon-glow-md);background:var(--bg-tertiary)}.username-form[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]::placeholder, .password-form[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]::placeholder{color:var(--text-muted);font-style:italic}.username-form[_ngcontent-%COMP%]   .form-input.error[_ngcontent-%COMP%], .password-form[_ngcontent-%COMP%]   .form-input.error[_ngcontent-%COMP%]{border-color:var(--error);box-shadow:0 0 5px var(--error)}.error-banner[_ngcontent-%COMP%]{background:var(--bg-card);border:2px solid var(--error);color:var(--error);padding:var(--space-md) var(--space-lg);display:flex;align-items:center;gap:var(--space-sm);font-weight:500;border-radius:var(--radius-md);margin:var(--space-md);animation:fadeIn .3s ease-out;box-shadow:0 0 5px var(--error)}.error-banner[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{font-size:var(--font-size-lg)}.loading-container[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;color:var(--text-secondary)}.loading-container[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{border:3px solid var(--border-muted);border-top:3px solid var(--neon-primary);border-radius:50%;width:30px;height:30px;animation:spin 1s linear infinite;margin-bottom:var(--space-md)}.chat-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:var(--space-md) var(--space-lg);background:var(--bg-secondary);border-bottom:1px solid var(--border-neon)}.chat-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%], .chat-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center}.chat-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]{justify-content:flex-start}.chat-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{justify-content:flex-end}.chat-header[_ngcontent-%COMP%]   .header-center[_ngcontent-%COMP%]{flex:2;text-align:center}.chat-header[_ngcontent-%COMP%]   .header-center[_ngcontent-%COMP%]   .room-logo-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:var(--space-sm);margin-bottom:var(--space-xs)}.chat-header[_ngcontent-%COMP%]   .header-center[_ngcontent-%COMP%]   .room-logo-container[_ngcontent-%COMP%]   .room-title[_ngcontent-%COMP%]{font-size:var(--font-size-lg);font-weight:600;margin:0;color:var(--neon-primary)}.chat-header[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]{background:none;border:none;color:var(--text-secondary);cursor:pointer;display:flex;align-items:center;gap:var(--space-xs);font-size:var(--font-size-sm);font-weight:500;padding:var(--space-sm) var(--space-md);border-radius:var(--radius-md);transition:all .3s ease}.chat-header[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]:hover{background:var(--bg-tertiary);color:var(--text-primary)}.chat-header[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]   .back-icon[_ngcontent-%COMP%]{font-size:var(--font-size-lg)}.chat-header[_ngcontent-%COMP%]   .room-title[_ngcontent-%COMP%]{font-size:var(--font-size-lg);font-weight:600;color:var(--text-primary);margin-bottom:var(--space-xs)}.chat-header[_ngcontent-%COMP%]   .room-status[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:var(--space-xs);font-size:var(--font-size-xs);color:var(--success);flex-direction:column}.chat-header[_ngcontent-%COMP%]   .room-status[_ngcontent-%COMP%]   .status-dot[_ngcontent-%COMP%]{width:4px;height:4px;border-radius:50%;background-color:var(--text-primary)}.chat-header[_ngcontent-%COMP%]   .room-status[_ngcontent-%COMP%]   .cleanup-notice[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-xs);margin-top:var(--space-xs);padding:var(--space-xs) var(--space-sm)}.chat-header[_ngcontent-%COMP%]   .room-status[_ngcontent-%COMP%]   .cleanup-text[_ngcontent-%COMP%]{font-size:var(--font-size-xs);color:var(--text-tertiary);font-weight:500}.chat-header[_ngcontent-%COMP%]   .encryption-status[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-xs);margin-top:var(--space-xs);padding:var(--space-xs) var(--space-sm)}.chat-header[_ngcontent-%COMP%]   .encryption-status[_ngcontent-%COMP%]   .encryption-text[_ngcontent-%COMP%]{font-size:var(--font-size-xs);color:var(--neon-accent);font-weight:600}.modern-toggle-switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:60px;height:30px;margin-right:var(--space-sm)}.modern-toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.modern-toggle-switch[_ngcontent-%COMP%]   .toggle-track[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:var(--bg-tertiary);border:1px solid var(--border-neon);border-radius:30px;transition:all .3s ease;box-shadow:var(--shadow-sm);display:flex;align-items:center;justify-content:space-between;padding:0 6px}.modern-toggle-switch[_ngcontent-%COMP%]   .toggle-track[_ngcontent-%COMP%]   .toggle-text[_ngcontent-%COMP%]{font-size:10px;font-weight:600;color:var(--text-primary);transition:all .3s ease;z-index:1}.modern-toggle-switch[_ngcontent-%COMP%]   .toggle-track[_ngcontent-%COMP%]   .toggle-thumb[_ngcontent-%COMP%]{position:absolute;height:24px;width:24px;left:3px;bottom:3px;background-color:var(--bg-primary);border:1px solid var(--border-neon);border-radius:50%;transition:all .3s ease;box-shadow:var(--shadow-sm);z-index:2}.modern-toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .toggle-track[_ngcontent-%COMP%]{background-color:var(--neon-primary);border-color:var(--neon-primary);box-shadow:var(--shadow-md)}.modern-toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .toggle-track[_ngcontent-%COMP%]   .toggle-text[_ngcontent-%COMP%]{color:var(--bg-primary)}.modern-toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .toggle-track[_ngcontent-%COMP%]   .toggle-thumb[_ngcontent-%COMP%]{background-color:var(--bg-primary);border-color:var(--neon-primary);box-shadow:var(--shadow-sm);transform:translate(30px)}.modern-toggle-switch[_ngcontent-%COMP%]:hover   .toggle-track[_ngcontent-%COMP%]{box-shadow:var(--shadow-md)}.modern-toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked:hover + .toggle-track[_ngcontent-%COMP%]{box-shadow:var(--shadow-sm)}.visibility-label[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:var(--font-size-xs);margin-right:var(--space-md)}.theme-toggle[_ngcontent-%COMP%]{background:var(--bg-secondary);border:1px solid var(--border-neon);border-radius:var(--radius-md);padding:var(--space-sm) var(--space-md);margin-right:var(--space-md);cursor:pointer;transition:background-color .2s ease;display:flex;align-items:center;gap:var(--space-xs)}.theme-toggle[_ngcontent-%COMP%]:hover{background:var(--bg-tertiary)}.theme-toggle[_ngcontent-%COMP%]   .theme-icon[_ngcontent-%COMP%]{font-size:var(--font-size-lg);color:var(--text-primary)}.theme-toggle[_ngcontent-%COMP%]   .theme-label[_ngcontent-%COMP%]{font-size:var(--font-size-sm);color:var(--text-primary);font-weight:500}.countdown-section[_ngcontent-%COMP%]{padding:var(--space-sm) var(--space-md);background:var(--bg-secondary);border-bottom:1px solid var(--border-neon)}.chat-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;background:var(--bg-tertiary);min-height:0}.messages-container[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;padding:var(--space-md);overflow-y:auto;scroll-behavior:smooth;min-height:0;max-height:calc(100vh - 200px);scrollbar-width:none;-ms-overflow-style:none}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.empty-messages[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;color:var(--text-secondary)}.empty-messages[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:var(--font-size-4xl);margin-bottom:var(--space-md);opacity:.7}.empty-messages[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:var(--font-size-lg);margin-bottom:var(--space-sm);color:var(--text-primary)}.empty-messages[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:var(--font-size-sm)}.messages-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-end;gap:var(--space-sm)}.message-item[_ngcontent-%COMP%]{display:flex;animation:fadeIn .3s ease-out}.message-item.own-message[_ngcontent-%COMP%]{justify-content:flex-end}.message-item.own-message[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]{background:var(--neon-primary);color:var(--bg-primary);border-color:var(--neon-primary);box-shadow:var(--shadow-sm)}.message-item.own-message[_ngcontent-%COMP%]   .message-meta[_ngcontent-%COMP%]{text-align:right;color:#fffc}.message-item.other-message[_ngcontent-%COMP%]{justify-content:flex-start}.message-item.other-message[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]{background:var(--bg-card);color:#fff;border-color:var(--user-color-dark, var(--border-neon));border-left:3px solid var(--user-color, var(--neon-primary))}.message-item.other-message[_ngcontent-%COMP%]   .message-meta[_ngcontent-%COMP%]{text-align:left;color:#fffc}.message-item[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]{max-width:80%;padding:var(--space-sm) var(--space-md);border-radius:var(--radius-lg);border:1px solid;box-shadow:var(--shadow-sm)}.message-item[_ngcontent-%COMP%]   .message-username[_ngcontent-%COMP%]{font-size:var(--font-size-xs);font-weight:600;color:var(--user-color, var(--neon-primary));margin-bottom:var(--space-xs);opacity:.9}.message-item[_ngcontent-%COMP%]   .message-text[_ngcontent-%COMP%]{font-size:var(--font-size-sm);word-wrap:break-word;margin-bottom:var(--space-xs)}.message-item[_ngcontent-%COMP%]   .message-meta[_ngcontent-%COMP%]{font-size:var(--font-size-xs)}.message-input-container[_ngcontent-%COMP%]{padding:var(--space-md);background:var(--bg-secondary);border-top:1px solid var(--border-neon);flex-shrink:0;position:sticky;bottom:0;z-index:10}.message-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--space-sm)}.message-form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{display:flex;gap:var(--space-sm);align-items:center}.message-form[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{flex:1;position:relative}.message-form[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .message-input[_ngcontent-%COMP%]{width:100%;padding:var(--space-md);border:2px solid var(--border-neon);border-radius:var(--radius-md);background:var(--bg-card);color:var(--text-primary);font-family:var(--font-family);transition:all .3s ease;box-shadow:var(--shadow-sm)}.message-form[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .message-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--neon-accent);box-shadow:var(--shadow-md);background:var(--bg-tertiary)}.message-form[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .message-input[_ngcontent-%COMP%]::placeholder{color:var(--text-muted);font-style:italic}.message-form[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .message-input.error[_ngcontent-%COMP%]{border-color:var(--error);box-shadow:0 0 5px var(--error)}.message-form[_ngcontent-%COMP%]   .send-button[_ngcontent-%COMP%]{background:var(--text-primary);color:var(--bg-primary);border:1px solid var(--text-primary);padding:var(--space-md);border-radius:var(--radius-md);font-size:var(--font-size-lg);width:50px;height:50px;flex-shrink:0;transition:background-color .2s ease;cursor:pointer}.message-form[_ngcontent-%COMP%]   .send-button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--bg-primary);color:var(--text-primary)}.message-form[_ngcontent-%COMP%]   .send-button[_ngcontent-%COMP%]:disabled{background:var(--bg-tertiary);border-color:var(--border-muted);color:var(--text-muted);cursor:not-allowed;opacity:.6}.message-form[_ngcontent-%COMP%]   .send-button[_ngcontent-%COMP%]   .send-icon[_ngcontent-%COMP%]{font-size:var(--font-size-lg)}.message-form[_ngcontent-%COMP%]   .send-button[_ngcontent-%COMP%]   .cooldown-text[_ngcontent-%COMP%]{font-size:var(--font-size-sm);font-weight:600;color:var(--text-muted)}.error-toast[_ngcontent-%COMP%], .success-toast[_ngcontent-%COMP%]{position:fixed;bottom:var(--space-lg);left:50%;transform:translate(-50%);background:var(--bg-card);border:2px solid;border-radius:var(--radius-md);padding:var(--space-md) var(--space-lg);display:flex;align-items:center;gap:var(--space-sm);font-size:var(--font-size-base);box-shadow:var(--shadow-md);z-index:100;animation:fadeIn .3s ease-out}.error-toast[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%], .error-toast[_ngcontent-%COMP%]   .success-icon[_ngcontent-%COMP%], .success-toast[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%], .success-toast[_ngcontent-%COMP%]   .success-icon[_ngcontent-%COMP%]{font-size:var(--font-size-lg)}.error-toast[_ngcontent-%COMP%]{border-color:var(--error);color:var(--error);box-shadow:0 0 5px #ef44444d}.success-toast[_ngcontent-%COMP%]{border-color:var(--success);color:var(--success);box-shadow:0 0 5px #10b9814d}.version-footer[_ngcontent-%COMP%]{text-align:center;padding:var(--space-md) var(--space-lg);background:var(--bg-secondary);border-top:1px solid var(--border-neon)}.version-footer[_ngcontent-%COMP%]   .version-text[_ngcontent-%COMP%]{font-size:var(--font-size-xs);color:var(--text-tertiary);margin:0;font-style:italic;opacity:.7}@media (max-width: 768px){.chat-room-container[_ngcontent-%COMP%]{margin:0;height:100vh;border-radius:0;border-left:none;border-right:none;border-top:none;box-shadow:none}.chat-header[_ngcontent-%COMP%]{padding:var(--space-sm) var(--space-md)}.chat-header[_ngcontent-%COMP%]   .room-title[_ngcontent-%COMP%]{font-size:var(--font-size-base)}.chat-header[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]{padding:var(--space-xs) var(--space-sm);font-size:var(--font-size-xs)}.message-input-container[_ngcontent-%COMP%]{padding:var(--space-sm);position:sticky;bottom:0}.messages-container[_ngcontent-%COMP%]{max-height:calc(100vh - 180px)}.modal-content[_ngcontent-%COMP%]{margin:var(--space-md)}}@media (max-width: 480px){.chat-room-container[_ngcontent-%COMP%]{border-left:none;border-right:none;border-top:none}.chat-header[_ngcontent-%COMP%]   .header-center[_ngcontent-%COMP%]{flex:1}.chat-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%], .chat-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{flex:0}.message-item[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]{max-width:90%}}']})};export{ue as ChatRoomComponent};
