<div class="home-container">
  <!-- Header Section -->
  <div class="header-section">
    <div class="header-content">
      <div class="logo-container">
        <h1 class="app-title">VaultDay</h1>
        <button 
          class="theme-toggle"
          (click)="toggleTheme()"
          [title]="isDark ? 'Chuyển sang Light Mode' : 'Chuyển sang Dark Mode'"
          appSoundClick
          soundType="button">
          <span class="theme-icon">{{ isDark ? '☀' : '○' }}</span>
          <span class="theme-label">{{ isDark ? 'Light' : 'Dark' }}</span>
        </button>
      </div>
      <p class="app-subtitle">Vault it today. Gone tomorrow</p>
      <div class="cleanup-info">
        <p class="cleanup-text">
          Tất cả phòng chat sẽ tự động xóa vào lúc 00:00
        </p>
      </div>
    </div>
  </div>

  <!-- Countdown Timer Section -->
  <div class="countdown-section">
    <app-countdown-timer></app-countdown-timer>
  </div>

  <!-- Public Rooms Section -->
  <div class="public-rooms-section">
    <div class="section-header">
      <h2 class="section-title">
        <span class="icon">●</span>
        Phòng Chat Hiện Có
      </h2>
    </div>
    <div class="rooms-list-container">
      <div *ngIf="isLoadingRooms" class="loading-state">
        <div class="loading-spinner"></div>
        <p>Đang tải danh sách phòng...</p>
      </div>
      <div *ngIf="!isLoadingRooms && publicRooms.length === 0" class="no-rooms">
        <p class="error-text">Chưa có phòng nào</p>
        <button 
          class="btn-secondary btn-sm" 
          (click)="loadPublicRooms()"
          appSoundClick
          soundType="button">
          <span class="refresh-icon">↻</span>
          Làm mới
        </button>
      </div>
      <div *ngIf="!isLoadingRooms && publicRooms.length > 0" class="rooms-list">
        <div 
          *ngFor="let room of publicRooms; trackBy: trackByRoomId" 
          class="room-item" 
          (click)="goToRoom(room.id)"
          appSoundClick
          soundType="button">
          <div class="room-info">
            <h3 class="room-name">{{ room.name }}</h3>
            <p class="room-meta">Tạo lúc: {{ room.created_at | date:'dd/MM/yyyy HH:mm' }}</p>
          </div>
        </div>
      </div>
      <div *ngIf="!isLoadingRooms && publicRooms.length > 0" class="refresh-button">
        <button 
          class="btn-secondary btn-sm" 
          (click)="loadPublicRooms()"
          appSoundClick
          soundType="button">
          <span class="refresh-icon">↻</span>
          Làm mới
        </button>
      </div>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="action-buttons">
    <button 
      class="btn-primary btn-lg" 
      (click)="showJoinRoom = !showJoinRoom"
      appSoundClick
      soundType="button">
      Tham Gia Phòng
    </button>
  </div>

  <!-- Join Room Form -->
  <div *ngIf="showJoinRoom" class="form-section">
    <div class="form-container">
      <h3 class="form-title">Tham Gia Phòng</h3>
      <form [formGroup]="joinRoomForm" (ngSubmit)="onJoinRoom()" class="join-form">
        <div class="form-group">
          <input
            type="text"
            formControlName="roomId"
            class="form-input"
            placeholder="Nhập mã phòng (6 ký tự)..."
            [class.error]="roomId?.invalid && roomId?.touched"
          />
          <div *ngIf="roomId?.invalid && roomId?.touched" class="error-message">
            <span *ngIf="roomId?.errors?.['required']">Mã phòng là bắt buộc</span>
            <span *ngIf="roomId?.errors?.['minlength'] || roomId?.errors?.['maxlength']">Mã phòng phải có đúng 6 ký tự</span>
          </div>
        </div>

        <button
          type="submit"
          class="btn-primary btn-lg w-full"
          [disabled]="joinRoomForm.invalid || isLoading"
          appSoundClick
          soundType="success"
        >
          <span *ngIf="!isLoading">Tham Gia</span>
          <span *ngIf="isLoading">Đang xử lý...</span>
        </button>
      </form>
    </div>
  </div>

  <!-- Generated Room Code Display -->
  <div *ngIf="generatedRoomCode" class="room-code-section">
    <div class="room-code-container">
      <h3 class="room-code-title">Mã Phòng Của Bạn</h3>
      <div class="room-code-display">
        <span class="room-code">{{ generatedRoomCode }}</span>
        <button 
          class="copy-btn" 
          (click)="copyRoomCode()"
          appSoundClick
          soundType="button">
          <span class="copy-icon">●</span>
        </button>
      </div>
      <p class="room-code-hint">Chia sẻ mã này để người khác có thể tham gia phòng</p>
    </div>
  </div>

  <!-- Room Status -->
  <!-- Messages -->
  <div *ngIf="errorMessage" class="error-toast">
    <span class="error-icon">●</span>
    {{ errorMessage }}
  </div>

  <div *ngIf="successMessage" class="success-toast">
    <span class="success-icon">●</span>
    {{ successMessage }}
  </div>

  <!-- Simple Footer -->
  <footer class="simple-footer">
    <div class="footer-content">
      <p class="footer-text">© 2025 VaultDay - Chat tạm thời với mã hóa</p>
      <p class="version-text">Version 1.0</p>
    </div>
  </footer>
</div>
